let recordPort=null;function isUndefined(e){return void 0===e}function getDB(){let e=null;indexedDB.open("AwesomeScreenshot",1).onsuccess=n=>{e=n.target.result;var i=e.transaction(["recordings"],"readwrite").objectStore("recordings").getAll();i.onsuccess=function(e){e.target.result},i.onerror=reject}}function saveStorage(e,n,i){chrome.storage.local.set({[e]:n},i)}function isBeforeVersion(e,n){var i=!1;if(n)for(var a=n.split("."),t=e.split("."),r=0;r<a.length;r++)if(a[r]<t[r]){i=!0;break}return i}function restoreStatus(){saveStorage("recordingStatus",""),chrome.action.setBadgeText({text:""})}function setDefaultOptions(){const e=navigator.userAgent.indexOf("Windows")>0;let n={};chrome.storage.local.get("options",(i=>{i.msObj||(n.msObj=e?{visible:{enable:!0,key:"1"},selected:{enable:!0,key:"S"},entire:{enable:!0,key:"E"}}:{visible:{enable:!0,key:"V"},selected:{enable:!0,key:"S"},entire:{enable:!0,key:"E"}}),isUndefined(i.format)&&(n.format="png"),isUndefined(i.delay_sec)&&(n.delay_sec=3),isUndefined(i.desktop_delay_sec)&&(n.desktop_delay_sec=0),isUndefined("remove-print-watermark")&&(n["remove-print-watermark"]=!1),isUndefined(i["data-tracking"])&&(n["data-tracking"]=!0),isUndefined(i["add-url"])&&(n["add-url"]=!1),isUndefined(i["expand-link"])&&(n["expand-link"]=!0),isUndefined(i["expand-link-slack"])&&(n["expand-link-slack"]=!0),isUndefined(i["expand-link-trello"])&&(n["expand-link-trello"]=!0),isUndefined(i["expand-link-asana"])&&(n["expand-link-asana"]=!0),isUndefined(i["expand-link-github"])&&(n["expand-link-github"]=!0),isUndefined(i["expand-link-jira"])&&(n["expand-link-jira"]=!0),isUndefined(i["expand-link-gmail"])&&(n["expand-link-gmail"]=!1),isUndefined(i["auto-save-path"])&&(n["auto-save-path"]=!0),i.aws_s&&32!==i.aws_s.length&&(n.aws_s="",n.aws_uid="",n.aws_username=""),isUndefined(i["show-noti"])&&(n["show-noti"]=!0),isUndefined(i.popupTab)&&isUndefined(i.version)?(n.popupTab="remember",n.activeTab="record"):isBeforeVersion("4.3.33",i.version)&&("record"===i.popupTab?(n.popupTab="remember",n.activeTab="record"):(n.popupTab="remember",n.activeTab="screenshot")),isUndefined(i["save-as"])&&(n["save-as"]=!0),isUndefined(i["allow-remind-mic"])&&(n["allow-remind-mic"]=!0),isUndefined(i.record_mic)&&(n.record_mic=!0),isUndefined(i.record_countdown)&&(n.record_countdown=3),isUndefined(i.max_resolution)&&(n.max_resolution="720"),isUndefined(i["save-location"])?(n["save-location"]="cloud",n["save-capture-location"]="cloud"):isUndefined(i["save-capture-location"])&&(n["save-capture-location"]="local"),isUndefined(i.record_tabsound)&&(n.record_tabsound=!0),isUndefined(i.record_toolbar)&&(n.record_toolbar=!0),isUndefined(i.record_type)&&(n.record_type="desktop"),isUndefined(i["gmail-btn"])&&(n["gmail-btn"]="true"),isUndefined(i["context-menu"])&&(n["context-menu"]="true"),isUndefined(i.ctl_bar)&&(n.ctl_bar="true"),chrome.storage.local.set({options:n},(()=>{}))}))}chrome.runtime.onConnect.addListener((e=>{"record"===e.name&&(recordPort=e),e.onDisconnect.addListener((e=>{restoreStatus()}))})),chrome.runtime.onInstalled.addListener((e=>{setDefaultOptions(),e.reason===chrome.runtime.OnInstalledReason.INSTALL&&chrome.runtime.setUninstallURL("https://www.awesomescreenshot.com/uninstall?appname=ss&source=ss&p1=uninstall&p2="+(/Edg/.test(window.navigator.userAgent)?"edge":"chrome"))}));